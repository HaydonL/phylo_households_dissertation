"0","# Same as above but flipped hh and comm (x axis vs fill colour)"
"0","p3<-ggplot(data = pairs_tsi, aes(x = COMM.RECIPIENT,fill = as.logical(same_hh))) +"
"0","  geom_bar()+"
"0","  labs(x='Recipient community',"
"0","       y='Number of infections',"
"0","       fill='Transmission type') +"
"0","  scale_fill_discrete(labels=c(""Out of HH"",""Within HH"")) +"
"0","  geom_errorbar( aes(x='fishing', ymin=binconf(nrow(pairs_tsi_same_hh[COMM.RECIPIENT=='fishing',]),nrow(pairs_tsi[COMM.RECIPIENT=='fishing',]))[2]*nrow(pairs_tsi[COMM.RECIPIENT=='fishing',]), ymax=binconf(nrow(pairs_tsi_same_hh[COMM.RECIPIENT=='fishing',]),nrow(pairs_tsi[COMM.RECIPIENT=='fishing',]))[3]*nrow(pairs_tsi[COMM.RECIPIENT=='fishing',])), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='inland', ymin=binconf(nrow(pairs_tsi_same_hh[COMM.RECIPIENT=='inland',]),nrow(pairs_tsi[COMM.RECIPIENT=='inland',]))[2]*nrow(pairs_tsi[COMM.RECIPIENT=='inland',]), ymax=binconf(nrow(pairs_tsi_same_hh[COMM.RECIPIENT=='inland',]),nrow(pairs_tsi[COMM.RECIPIENT=='inland',]))[3]*nrow(pairs_tsi[COMM.RECIPIENT=='inland',])), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)"
"0","  "
"0","  "
"0",""
"0","p4<-ggplot(data = pairs_tsi, aes(x = COMM.RECIPIENT,fill = as.logical(same_hh))) +"
"0","  geom_bar(position='fill')+"
"0","  labs(x='Recipient community',"
"0","       y='Proportion of infections',"
"0","       fill='Transmission type') +"
"0","  scale_fill_discrete(labels=c(""Out of HH"",""Within HH"")) +"
"0","  geom_errorbar( aes(x='fishing', ymin=binconf(nrow(pairs_tsi_same_hh[COMM.RECIPIENT=='fishing',]),nrow(pairs_tsi[COMM.RECIPIENT=='fishing',]))[2], ymax=binconf(nrow(pairs_tsi_same_hh[COMM.RECIPIENT=='fishing',]),nrow(pairs_tsi[COMM.RECIPIENT=='fishing',]))[3]), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='inland', ymin=binconf(nrow(pairs_tsi_same_hh[COMM.RECIPIENT=='inland',]),nrow(pairs_tsi[COMM.RECIPIENT=='inland',]))[2], ymax=binconf(nrow(pairs_tsi_same_hh[COMM.RECIPIENT=='inland',]),nrow(pairs_tsi[COMM.RECIPIENT=='inland',]))[3]), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)"
"0",""
"0","p <- ggarrange(p3, p4, ncol=2, nrow=1, common.legend = TRUE, legend=""bottom"")"
"0","p2<-annotate_figure(p, top=""Colored by transmission type"")"
"0","annotate_figure(p2, top=""Infections by recipient community"")"
