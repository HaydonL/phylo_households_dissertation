"0","tmp<-pairs_tsi"
"0","tmp[is.na(ROUND.M)==TRUE,]$M"
"1","[1]"
"1"," ""2000-04-09"""
"1"," ""2002-08-24"""
"1"," ""2003-03-06"""
"1"," ""2018-11-17"""
"1"," ""2002-08-29"""
"1","
"
"1","[6]"
"1"," ""2002-10-07"""
"1"," ""2001-05-06"""
"1"," ""2002-06-14"""
"1","
"
"0","tmp[is.na(ROUND.M)==TRUE & year(M)<=2003,]$ROUND.M<-'before R10'"
"0","tmp[is.na(ROUND.M)==TRUE & year(M)>=2018,]$ROUND.M<-'after R18'"
"0","pairs_tsi<-tmp"
"0","pairs_tsi$ROUND.M<-factor(pairs_tsi$ROUND.M,levels=c('before R10','R010','R011','R012','R013','R014','R015','R016','R017','R018','after R18'))"
"0","pairs_tsi_same_hh<-pairs_tsi[same_hh==1,]"
"0","pairs_tsi_diff_hh<-pairs_tsi[same_hh==0,]"
"0",""
"0","p2<-ggplot(data = pairs_tsi, aes(x = ROUND.M ,fill = as.logical(same_hh))) +"
"0","  geom_bar(position=""fill"")+"
"0","  labs(x='Round',"
"0","       y='Proportion of infections',"
"0","       fill='Same HH') +"
"0","  geom_errorbar( aes(x='before R10', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='before R10',]),nrow(pairs_tsi[ROUND.M=='before R10',]))[2], ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='before R10',]),nrow(pairs_tsi[ROUND.M=='before R10',]))[3]), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='R010', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R010',]),nrow(pairs_tsi[ROUND.M=='R010',]))[2], ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R010',]),nrow(pairs_tsi[ROUND.M=='R010',]))[3]), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='R011', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R011',]),nrow(pairs_tsi[ROUND.M=='R011',]))[2], ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R011',]),nrow(pairs_tsi[ROUND.M=='R011',]))[3]), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='R012', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R012',]),nrow(pairs_tsi[ROUND.M=='R012',]))[2], ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R012',]),nrow(pairs_tsi[ROUND.M=='R012',]))[3]), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='R013', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R013',]),nrow(pairs_tsi[ROUND.M=='R013',]))[2], ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R013',]),nrow(pairs_tsi[ROUND.M=='R013',]))[3]), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='R014', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R014',]),nrow(pairs_tsi[ROUND.M=='R014',]))[2], ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R014',]),nrow(pairs_tsi[ROUND.M=='R014',]))[3]), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='R015', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R015',]),nrow(pairs_tsi[ROUND.M=='R015',]))[2], ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R015',]),nrow(pairs_tsi[ROUND.M=='R015',]))[3]), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='R016', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R016',]),nrow(pairs_tsi[ROUND.M=='R016',]))[2], ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R016',]),nrow(pairs_tsi[ROUND.M=='R016',]))[3]), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='R017', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R017',]),nrow(pairs_tsi[ROUND.M=='R017',]))[2], ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R017',]),nrow(pairs_tsi[ROUND.M=='R017',]))[3]), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='R018', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R018',]),nrow(pairs_tsi[ROUND.M=='R018',]))[2], ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R018',]),nrow(pairs_tsi[ROUND.M=='R018',]))[3]), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='after R18', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='after R18',]),nrow(pairs_tsi[ROUND.M=='after R18',]))[2], ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='after R18',]),nrow(pairs_tsi[ROUND.M=='after R18',]))[3]), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  scale_fill_discrete(labels=c(""Out of HH"",""Within HH"")) +"
"0","  scale_x_discrete(labels=c(""before"",""R10"",'R11','R12','R13','R14','R15','R16','R17','R18','after R18'))"
"0",""
"0","       "
"0","p1<-ggplot(data = pairs_tsi, aes(x = ROUND.M,fill = as.logical(same_hh))) +"
"0","  geom_bar()+"
"0","  labs(x='Round',"
"0","       y='Number of infections',"
"0","       fill='Transmission type')+"
"0","  geom_errorbar( aes(x='before R10', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='before R10',]),nrow(pairs_tsi[ROUND.M=='before R10',]))[2]*nrow(pairs_tsi[ROUND.M=='before R10',]), ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='before R10',]),nrow(pairs_tsi[ROUND.M=='before R10',]))[3]*nrow(pairs_tsi[ROUND.M=='before R10',])), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='R010', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R010',]),nrow(pairs_tsi[ROUND.M=='R010',]))[2]*nrow(pairs_tsi[ROUND.M=='R010',]), ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R010',]),nrow(pairs_tsi[ROUND.M=='R010',]))[3]*nrow(pairs_tsi[ROUND.M=='R010',])), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='R011', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R011',]),nrow(pairs_tsi[ROUND.M=='R011',]))[2]*nrow(pairs_tsi[ROUND.M=='R011',]), ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R011',]),nrow(pairs_tsi[ROUND.M=='R011',]))[3]*nrow(pairs_tsi[ROUND.M=='R011',])), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='R012', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R012',]),nrow(pairs_tsi[ROUND.M=='R012',]))[2]*nrow(pairs_tsi[ROUND.M=='R012',]), ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R012',]),nrow(pairs_tsi[ROUND.M=='R012',]))[3]*nrow(pairs_tsi[ROUND.M=='R012',])), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='R013', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R013',]),nrow(pairs_tsi[ROUND.M=='R013',]))[2]*nrow(pairs_tsi[ROUND.M=='R013',]), ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R013',]),nrow(pairs_tsi[ROUND.M=='R013',]))[3]*nrow(pairs_tsi[ROUND.M=='R013',])), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='R014', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R014',]),nrow(pairs_tsi[ROUND.M=='R014',]))[2]*nrow(pairs_tsi[ROUND.M=='R014',]), ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R014',]),nrow(pairs_tsi[ROUND.M=='R014',]))[3]*nrow(pairs_tsi[ROUND.M=='R014',])), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='R015', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R015',]),nrow(pairs_tsi[ROUND.M=='R015',]))[2]*nrow(pairs_tsi[ROUND.M=='R015',]), ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R015',]),nrow(pairs_tsi[ROUND.M=='R015',]))[3]*nrow(pairs_tsi[ROUND.M=='R015',])), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='R016', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R016',]),nrow(pairs_tsi[ROUND.M=='R016',]))[2]*nrow(pairs_tsi[ROUND.M=='R016',]), ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R016',]),nrow(pairs_tsi[ROUND.M=='R016',]))[3]*nrow(pairs_tsi[ROUND.M=='R016',])), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='R017', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R017',]),nrow(pairs_tsi[ROUND.M=='R017',]))[2]*nrow(pairs_tsi[ROUND.M=='R017',]), ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R017',]),nrow(pairs_tsi[ROUND.M=='R017',]))[3]*nrow(pairs_tsi[ROUND.M=='R017',])), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='R018', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R018',]),nrow(pairs_tsi[ROUND.M=='R018',]))[2]*nrow(pairs_tsi[ROUND.M=='R018',]), ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='R018',]),nrow(pairs_tsi[ROUND.M=='R018',]))[3]*nrow(pairs_tsi[ROUND.M=='R018',])), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  geom_errorbar( aes(x='after R18', ymin=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='after R18',]),nrow(pairs_tsi[ROUND.M=='after R18',]))[2]*nrow(pairs_tsi[ROUND.M=='after R18',]), ymax=binconf(nrow(pairs_tsi_same_hh[ROUND.M=='after R18',]),nrow(pairs_tsi[ROUND.M=='after R18',]))[3]*nrow(pairs_tsi[ROUND.M=='after R18',])), width=0.4, colour=""black"", alpha=0.9, linewidth=1.3)+"
"0","  scale_fill_discrete(labels=c(""Out of HH"",""Within HH"")) +"
"0","  scale_x_discrete(labels=c(""before"",""R10"",'R11','R12','R13','R14','R15','R16','R17','R18','after R18'))"
"0","  "
"0","ggarrange(p1, p2, ncol=1, nrow=2, common.legend = TRUE, legend=""right"")"
